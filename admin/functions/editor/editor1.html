<!-- Modified for SendStudio to include COMPLETE html code. ToggleMode and GetHTML functions -->
<style>

.wysiwyg_table {
	background: threedface;
}

.wysiwyg_editiframe {
	width: 100%;
	height: 85%;
	border: 0px;
	margin: 0px;
}

.wysiwyg_button
{
	border: 1px threedface solid;
	cursor: hand;
}

.wysiwyg_container
{
   border-left: 1px buttonshadow solid;
   border-top: 1px buttonshadow solid;
   border-right: 1px buttonhighlight solid;
   border-bottom: 1px buttonhighlight solid;
}

.wysiwyg_outside
{
   border-left: 1px buttonhighlight solid;
   border-top: 1px buttonhighlight solid;
   border-right: 1px buttonshadow solid;
   border-bottom: 1px buttonshadow solid;
}

.Text90
{
    FONT-SIZE: 11px;
    WIDTH: 90px;
    COLOR: #333333;
    FONT-FAMILY: arial
}

.Text50
{
    FONT-SIZE: 11px;
    WIDTH: 50px;
    COLOR: #333333;
    FONT-FAMILY: arial
}

</style>
</head>
<body onload=doLoad()>

<script language="JavaScript">

HTTPStr = '%HTTPSTR%'
URL = '%URL%'
ModifyImageFile = '%MODIFY_IMAGE_FILE%'
ImagesFile = '%INSERT_IMAGE_FILE%'

function Browser() {

  this.IE    = false;
  this.NS    = false;

  var userAgent;
  userAgent = navigator.userAgent;

  if ((userAgent.indexOf("MSIE")) >= 0) {
    this.IE = true;
    return;
  }

  if ((userAgent.indexOf("Netscape6/")) >= 0) {
    this.NS = true;
    return;
  }

  if ((userAgent.indexOf("Gecko")) >= 0) {
    this.NS = true;
    return;
  }
}

var browser = new Browser();

var mode = 0; // 0 = WYSIWYG, 1 = Source
function toggleSourceMode()
{
	if (browser.NS) {

		if (mode == 0)
		{
			mode = 1;
			var fullsource = "<html>" + getIFrameDocument('foo').body.parentNode.innerHTML + "</html>";
			var html = document.createTextNode(fullsource);
			getIFrameDocument('foo').body.innerHTML = '';
			getIFrameDocument('foo').body.appendChild(html);
            getIFrameDocument('foo').body.style.fontFamily = 'Verdana';
            getIFrameDocument('foo').body.style.fontSize = '11px';
		}
		else
		{
			mode = 0;
			var r = getIFrameDocument('foo').body.ownerDocument.createRange();
			r.selectNodeContents(getIFrameDocument('foo').body);
			html = r.toString();

            getIFrameDocument('foo').open();
			getIFrameDocument('foo').write(html);
			getIFrameDocument('foo').close();
            getIFrameDocument('foo').body.style.fontFamily = '';
            getIFrameDocument('foo').body.style.fontSize = '';
		}

	} else {

		if (mode == 0)
		{
			mode = 1;
			foo.document.body.innerText = foo.document.documentElement.outerHTML;
			foo.document.body.runtimeStyle.fontFamily = "Verdana"
			foo.document.body.runtimeStyle.fontSize = "11px";
			foo.document.body.runtimeStyle.color = "#000000";
			foo.document.body.runtimeStyle.bgColor = "#FFFFFF";
			foo.document.body.runtimeStyle.text = "#000000";
			foo.document.body.runtimeStyle.background = "";
			foo.document.body.runtimeStyle.marginTop = "10px";
			foo.document.body.runtimeStyle.marginLeft = "10px";
		}
		else
		{
			mode = 0;
			foo.document.body.runtimeStyle.cssText = "";

			if (foo.document.body.outerText != "") {
				foo.document.write(foo.document.body.outerText);
				foo.document.close();
			}
		}
	}
}

function makeFullScreen()
{
	e = document.getElementById("container")
	f = document.getElementById("foo")
	if(e.style.position != 'absolute')
	{
		e.style.position = 'absolute';
		e.style.left = 10;
		e.style.top = 10;
		e.style.width = document.body.clientWidth - 20;
		e.style.height = document.body.clientHeight - 20;

		f.style.height = document.body.clientHeight - 80;

		// For netscape
		getIFrameDocument("foo").designMode = "On";
		button_out(document.getElementById('fullScreenButton'))
	}
	else
	{
		e.style.position = 'relative';
		e.style.left = 0;
		e.style.top = 0;
		e.style.width = '%WIDTH%';
		e.style.height = '%HEIGHT%';
		f.style.height = (%HEIGHT%)-60

		// For netscape
		getIFrameDocument("foo").designMode = "On";
		button_out(document.getElementById('fullScreenButton'))
	}

	window.scrollTo(0,0);
}

function button_over(eButton){
	eButton.style.borderBottom = "#808080 solid 1px";
	eButton.style.borderLeft = "#FFFFFF solid 1px";
	eButton.style.borderRight = "#808080 solid 1px";
	eButton.style.borderTop = "#FFFFFF solid 1px";
}

function button_out(eButton){
	eButton.style.borderColor = "#d4d0c8";
}

function button_down(eButton){
	eButton.style.borderBottom = "#FFFFFF solid 1px";
	eButton.style.borderLeft = "#808080 solid 1px";
	eButton.style.borderRight = "#FFFFFF solid 1px";
	eButton.style.borderTop = "#808080 solid 1px";
}

function showColor(selectedColor, oColor) {
	if (oColor.style.backgroundColor.toUpperCase() == "")
		colorCode = "&nbsp;";
	else 
		colorCode = oColor.style.backgroundColor.toUpperCase();

	selectedColor.innerHTML = colorCode;
	selectedColor.style.backgroundColor = oColor.style.backgroundColor
}

function doColor(oColor) {
	if (colorType == 2) {
		myCommand = 'BackColor'
	} else {
		myCommand = 'ForeColor'
	}

	foo.document.execCommand(myCommand,false,oColor);
	oPopup.hide()
}

var colorType
function applyColor(oColor) {
	var selectedColor = oColor.id;

	if (browser.IE) {
		doColor(selectedColor)
	} else {
		if (colorType == 2) {
			getIFrameDocument('foo').execCommand("hilitecolor", false, selectedColor);
			document.getElementById("backColor").innerHTML = ""
			document.getElementById('foo').contentWindow.focus()
			button_out(document.getElementById('backColorButton'))
		} else {
			getIFrameDocument('foo').execCommand("forecolor", false, selectedColor);
			document.getElementById("fontColor").innerHTML = ""
			document.getElementById('foo').contentWindow.focus()
			button_out(document.getElementById('fontColorButton'))
		}

	}
}

function doFont(oFont) {
	foo.document.execCommand('FontName',false,oFont)
	foo.focus()
	oPopup.hide()
}

function doSize(oSize) {
	foo.document.execCommand('FontSize',false,oSize)
	foo.focus()
	oPopup.hide()
}

if (browser.IE) {
	var oPopup = window.createPopup();
}

function showMenu(menu, width, height)
{

	var lefter = event.clientX;
	var leftoff = event.offsetX
	var topper = event.clientY;
	var topoff = event.offsetY;
	var oPopBody = oPopup.document.body;
	moveMe = 0

	if (menu == "colorMenu") {
		colorType = "0"
	}

	if (menu == "colorMenu2") {
		colorType = "2"
		menu = "colorMenu"
	}

	var HTMLContent = eval(menu).innerHTML
	oPopBody.innerHTML = HTMLContent
	oPopup.show(lefter - leftoff - 2 - moveMe, topper - topoff + 22, width, height, document.body);

	return false;
}

function isImageSelected() {
	if (foo.document.selection.type == "Control") {
		var oControlRange = foo.document.selection.createRange();
		if (oControlRange(0).tagName.toUpperCase() == "IMG") {
			selectedImage = foo.document.selection.createRange()(0);
			return true;
		}
	}
}

function doImage() {
	if (browser.NS) {
		var leftPos = (screen.availWidth-700) / 2
		var topPos = (screen.availHeight-500) / 2 
		imageWin = window.open(ImagesFile,'','width=700,height=500,scrollbars=yes,resizable=yes,status=yes,titlebar=0,top=' + topPos + ',left=' + leftPos);
	} else {
		var leftPos = (screen.availWidth-700) / 2
		var topPos = (screen.availHeight-500) / 2 
		imageWin = window.open(ImagesFile,'','width=700,height=500,scrollbars=yes,resizable=yes,status=yes,titlebar=0,top=' + topPos + ',left=' + leftPos);
	}
}

	</script>

<!--	<div id="container" style="width:%WIDTH%; height:%HEIGHT%" class="wysiwyg_container %CSS_CLASS%"> -->
 	<div id="container" style="width:%WIDTH%; height:%HEIGHT%" class="wysiwyg_container %CSS_CLASS%">
		<table width="100%" height="100%" border="0" cellspacing="0" cellpadding="0" class="wysiwyg_outside"><tr><td>
					<table cellspacing="3" cellpadding="0" id="toolBar" width="100%" border="0" class="wysiwyg_table">
						<tr>
							<td width="21" id="fullScreenButton" onclick="makeFullScreen()" onMouseOver="button_over(this)" onMouseOut="button_out(this)" onmousedown="button_down(this);" class="wysiwyg_button"><img title="Toggle Full Screen Editing Mode" src="%EDITOR_PATH%images/fullscreen.gif" width="21" height="20" unselectable="on"></td>
							<td width="2"><img src="%EDITOR_PATH%images/spacer.gif" width="2" height="22"></td>
							<script>
							if (browser.NS) {
								document.write('<td width="21" onclick="doCommand(\'bold\')" onMouseOver="button_over(this)" onMouseOut="button_out(this)" onmousedown="button_down(this);" class="wysiwyg_button"><img src="%EDITOR_PATH%images/bold.gif" width="21" height="20" unselectable="on"></td>')

								document.write('<td width="21" onclick="doCommand(\'Italic\')" onMouseOver="button_over(this)" onMouseOut="button_out(this)" onmousedown="button_down(this);" class="wysiwyg_button"><img src="%EDITOR_PATH%images/italic.gif" width="21" height="20" unselectable="on"></td>')

								document.write('<td width="21" onclick="doCommand(\'Underline\')" onMouseOver="button_over(this)" onMouseOut="button_out(this)" onmousedown="button_down(this);" class="wysiwyg_button"><img src="%EDITOR_PATH%images/underline.gif" width="21" height="20" unselectable="on"></td>')

								document.write('<td width="2"><img src="%EDITOR_PATH%images/spacer.gif" width="2" height="22"></td>')
							}
							</script>

							<script>
							if (browser.IE) {
								document.write('<td width="21" onclick="doCommand(\'Cut\')" onMouseOver="button_over(this)" onMouseOut="button_out(this)" onmousedown="button_down(this);" class="wysiwyg_button"><img src="%EDITOR_PATH%images/cut.gif" width="21" height="20" unselectable="on"></td>')
								
								document.write('<td width="21" onclick="doCommand(\'Copy\')" onMouseOver="button_over(this)" onMouseOut="button_out(this)" onmousedown="button_down(this);" class="wysiwyg_button"><img src="%EDITOR_PATH%images/copy.gif" width="21" height="20" unselectable="on"></td>')
								
								document.write('<td width="21" onclick="doCommand(\'Paste\')" onMouseOver="button_over(this)" onMouseOut="button_out(this)" onmousedown="button_down(this);" class="wysiwyg_button"><img src="%EDITOR_PATH%images/paste.gif" width="21" height="20" unselectable="on"></td>')
								
								document.write('<td width="2"><img src="%EDITOR_PATH%images/spacer.gif" width="2" height="22"></td>')
							}
							</script>
							<td width="21" onclick="doCommand('InsertOrderedList')" onMouseOver="button_over(this)" onMouseOut="button_out(this)" onmousedown="button_down(this);" class="wysiwyg_button"><img src="%EDITOR_PATH%images/ordered.gif" width="21" height="20" unselectable="on"></td>
							<td width="21" onclick="doCommand('InsertUnorderedList')" onMouseOver="button_over(this)" onMouseOut="button_out(this)" onmousedown="button_down(this);" class="wysiwyg_button"><img src="%EDITOR_PATH%images/unordered.gif" width="21" height="20" unselectable="on"></td>
							<td width="2"><img src="%EDITOR_PATH%images/spacer.gif" width="2" height="22"></td>
							<td width="48" onclick="doCommand('createlink')" onMouseOver="button_over(this)" onMouseOut="button_out(this)" onmousedown="button_down(this);" class="wysiwyg_button"><img src="%EDITOR_PATH%images/link.gif" width="48" height="20" unselectable="on"></td>
							<td width="57" onclick="doImage()" onMouseOver="button_over(this)" onMouseOut="button_out(this)" onmousedown="button_down(this);" class="wysiwyg_button"><img src="%EDITOR_PATH%images/image.gif" width="57" height="20" unselectable="on"></td>
							<td width="2"><img src="%EDITOR_PATH%images/spacer.gif" width="2" height="22"></td>
							<td width="21" onclick="toggleSourceMode()" onMouseOver="button_over(this)" onMouseOut="button_out(this)" onmousedown="button_down(this);" class="wysiwyg_button"><img title="Toggle Source Mode" src="%EDITOR_PATH%images/sourcemode.gif" width="21" height="20" unselectable="on"></td>
							<td><img src="%EDITOR_PATH%images/1x1.gif" width="1" height="1"></td>
						</tr>
					</table>

					<table cellspacing="0" cellpadding="0" width="100%" border="0">
						<tr>
							<td colspan="25" bgcolor="#808080"><img src="%EDITOR_PATH%images/1x1.gif" width="1" height="1"></td>
						</tr>
						<tr>
							<td colspan="25" bgcolor="#FFFFFF"><img src="%EDITOR_PATH%images/1x1.gif" width="1" height="1"></td>
						</tr>
					</table>

					<table cellspacing="3" cellpadding="0" id="toolBar2" width="100%" border="0" class="wysiwyg_table">
						<tr>
							<td width="20">
								<select id="fontDrop" onChange="doCommand('fontName', this[this.selectedIndex].value); this.selectedIndex = 0" class="Text90" unselectable="on">
									<option selected>Font</option>
									<option value="Times New Roman">Default</option>
									<option value="Arial">Arial</option>
									<option value="Verdana">Verdana</option>
									<option value="Tahoma">Tahoma</option>
									<option value="Geneva">Geneva</option>
									<option value="Helvetica">Helvetica</option>
									<option value="Courier New">Courier New</option>
									<option value="Georgia">Georgia</option>
								</select>
							</td>
							<td width="20">
								<select id="sizeDrop" onChange="doCommand('fontSize', this[this.selectedIndex].value); this.selectedIndex = 0" class="Text50" unselectable="on">
									<option SELECTED>Size
									<option value="1">1
									<option value="2">2
									<option value="3">3
									<option value="4">4
									<option value="5">5
									<option value="6">6
									<option value="7">7
								</select>
							</td>
							<td width="2"><img src="%EDITOR_PATH%images/spacer.gif" width="2" height="22"></td>
							<script>
							if (browser.IE) {
								document.write('<td width="21" onclick="doCommand(\'bold\')" onMouseOver="button_over(this)" onMouseOut="button_out(this)" onmousedown="button_down(this);" class="wysiwyg_button"><img src="%EDITOR_PATH%images/bold.gif" width="21" height="20" unselectable="on"></td>')

								document.write('<td width="21" onclick="doCommand(\'Italic\')" onMouseOver="button_over(this)" onMouseOut="button_out(this)" onmousedown="button_down(this);" class="wysiwyg_button"><img src="%EDITOR_PATH%images/italic.gif" width="21" height="20" unselectable="on"></td>')

								document.write('<td width="21" onclick="doCommand(\'Underline\')" onMouseOver="button_over(this)" onMouseOut="button_out(this)" onmousedown="button_down(this);" class="wysiwyg_button"><img src="%EDITOR_PATH%images/underline.gif" width="21" height="20" unselectable="on"></td>')

								document.write('<td width="2"><img src="%EDITOR_PATH%images/spacer.gif" width="2" height="22"></td>')
							}
							</script>

							<td width="21" onclick="doCommand('JustifyLeft')" onMouseOver="button_over(this)" onMouseOut="button_out(this)" onmousedown="button_down(this);" class="wysiwyg_button"><img src="%EDITOR_PATH%images/align_left.gif" width="21" height="20" unselectable="on"></td>
							<td width="21" onclick="doCommand('JustifyCenter')" onMouseOver="button_over(this)" onMouseOut="button_out(this)" onmousedown="button_down(this);" class="wysiwyg_button"><img src="%EDITOR_PATH%images/align_center.gif" width="21" height="20" unselectable="on"></td>
							<td width="21" onclick="doCommand('JustifyRight')" onMouseOver="button_over(this)" onMouseOut="button_out(this)" onmousedown="button_down(this);" class="wysiwyg_button"><img src="%EDITOR_PATH%images/align_right.gif" width="21" height="20" unselectable="on"></td>
							<td width="2"><img src="%EDITOR_PATH%images/spacer.gif" width="2" height="22"></td>
							<td width="21" onclick="doFontColor()" onMouseOver="button_over(this)" onMouseOut="button_out(this)" onmousedown="button_down(this);" class="wysiwyg_button" id="fontColorButton"><img src="%EDITOR_PATH%images/font_color.gif" width="21" height="20" unselectable="on"><div id="fontColor" style="z-index:2000"></div></td>
							<td width="21" onclick="doBackColor()" onMouseOver="button_over(this)" onMouseOut="button_out(this)" onmousedown="button_down(this);" class="wysiwyg_button" id="backColorButton"><img src="%EDITOR_PATH%images/highlight.gif" width="21" height="20" unselectable="on"><div id="backColor" style="z-index:2001"></td>
							<td width="100%"></td>

						</tr>
					</table>

					<table cellspacing="0" cellpadding="0" width="100%" border="0">
						<tr>
							<td colspan="8" bgcolor="#808080"><img src="%EDITOR_PATH%images/1x1.gif" width="1" height="1"></td>
						</tr>
						<tr>
							<td colspan="8" bgcolor="#FFFFFF"><img src="%EDITOR_PATH%images/1x1.gif" width="1" height="1"></td>
						</tr>
					</table>
					<input type="hidden" name="%FIELD_ID%" id="%FIELD_ID%" value="">
					<iframe style="width:100%" frameborder="0" id="foo" class="wysiwyg_editiframe" style="z-index:1998" onBlur="getHTML()"></iframe>
				</td></tr></table></div>


	<!-- Drop Down Menu's -->
	<DIV ID="colorMenu" STYLE="visibility:hidden; position:absolute;" style="z-index:1999">
		<table cellpadding="1" cellspacing="5" border="1" bordercolor="#666666" style="cursor: hand;font-family: Verdana; font-size: 7px; BORDER-LEFT: buttonhighlight 1px solid; BORDER-RIGHT: buttonshadow 2px solid; BORDER-TOP: buttonhighlight 1px solid; BORDER-BOTTOM: buttonshadow 1px solid; background-color: threedface">
			<tr>
				<td colspan="10" id="selectedColor" style="height=20px;font-family: verdana; font-size:12px;">&nbsp;</td>
			</tr>
			<tr>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#FF0000;width:10px" id="#FF0000">&nbsp;&nbsp;&nbsp;&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#FFFF00;width:10px" id="#FFFF00">&nbsp;&nbsp;&nbsp;&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#00FF00;width:10px" id="#00FF00">&nbsp;&nbsp;&nbsp;&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#00FFFF;width:10px" id="#00FFFF">&nbsp;&nbsp;&nbsp;&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#0000FF;width:10px" id="#0000FF">&nbsp;&nbsp;&nbsp;&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#FF00FF;width:10px" id="#FF00FF">&nbsp;&nbsp;&nbsp;&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#FFFFFF;width:10px" id="#FFFFFF">&nbsp;&nbsp;&nbsp;&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#F5F5F5;width:10px" id="#F5F5F5">&nbsp;&nbsp;&nbsp;&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#DCDCDC;width:10px" id="#DCDCDC">&nbsp;&nbsp;&nbsp;&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#FFFAFA;width:10px" id="#FFFAFA">&nbsp;&nbsp;&nbsp;&nbsp;</td>
			</tr>
			<tr>
				<td onMouseOver="parent.parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#D3D3D3" id="#D3D3D3">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#C0C0C0" id="#C0C0C0">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#A9A9A9" id="#A9A9A9">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#808080" id="#808080">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#696969">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#000000" id="#000000">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#2F4F4F" id="#2F4F4F">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#708090" id="#708090">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#778899" id="#778899">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#4682B4" id="#4682B4">&nbsp;</td>
			</tr>
			<tr>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#4169E1" id="#4169E1">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#6495ED" id="#6495ED">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#B0C4DE" id="#B0C4DE">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#7B68EE" id="#7B68EE">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#6A5ACD" id="#6A5ACD">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#483D8B" id="#483D8B">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#191970" id="#191970">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#000080" id="#000080">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#00008B" id="#00008B">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#0000CD" id="#0000CD">&nbsp;</td>
			</tr>
			<tr>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#1E90FF" id="#1E90FF">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#00BFFF" id="#00BFFF">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#87CEFA" id="#87CEFA">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#87CEEB" id="#87CEEB">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#ADD8E6" id="#ADD8E6">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#B0E0E6" id="#B0E0E6">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#F0FFFF" id="#F0FFFF">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#E0FFFF" id="#E0FFFF">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#AFEEEE" id="#AFEEEE">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#00CED1" id="#00CED1">&nbsp;</td>
			</tr>
			<tr>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#5F9EA0" id="#5F9EA0">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#48D1CC" id="#48D1CC">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#00FFFF" id="#00FFFF">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#40E0D0" id="#40E0D0">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#20B2AA" id="#20B2AA">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#008B8B" id="#008B8B">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#008080" id="#008080">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#7FFFD4" id="#7FFFD4">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#66CDAA" id="#66CDAA">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#8FBC8F" id="#8FBC8F">&nbsp;</td>
			</tr>
			<tr>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#3CB371" id="#3CB371">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#2E8B57" id="#2E8B57">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#006400" id="#006400">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#008000" id="#008000">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#228B22" id="#228B22">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#32CD32" id="#32CD32">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#00FF00" id="#00FF00">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#7FFF00" id="#7FFF00">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#7CFC00" id="#7CFC00">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#ADFF2F" id="#ADFF2F">&nbsp;</td>
			</tr>
			<tr>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#98FB98" id="#98FB98">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#90EE90" id="#90EE90">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#00FF7F" id="#00FF7F">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#00FA9A" id="#00FA9A">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#556B2F" id="#556B2F">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#6B8E23" id="#6B8E23">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#808000" id="#808000">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#BDB76B" id="#BDB76B">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#B8860B" id="#B8860B">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#DAA520" id="#DAA520">&nbsp;</td>
			</tr>
			<tr>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#FFD700" id="#FFD700">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#F0E68C" id="#F0E68C">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#EEE8AA" id="#EEE8AA">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#FFEBCD" id="#FFEBCD">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#FFE4B5" id="#FFE4B5">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#F5DEB3" id="#F5DEB3">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#FFDEAD" id="#FFDEAD">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#DEB887" id="#DEB887">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#D2B48C" id="#D2B48C">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#BC8F8F" id="#BC8F8F">&nbsp;</td>
			</tr>
			<tr>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#A0522D" id="#A0522D">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#8B4513" id="#8B4513">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#D2691E" id="#D2691E">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#CD853F" id="#CD853F">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#F4A460" id="#F4A460">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#8B0000" id="#8B0000">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#800000" id="#800000">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#A52A2A" id="#A52A2A">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#B22222" id="#B22222">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#CD5C5C" id="#CD5C5C">&nbsp;</td>
			</tr>
			<tr>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#F08080" id="#F08080">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#FA8072" id="#FA8072">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#E9967A" id="#E9967A">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#FFA07A" id="#FFA07A">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#FF7F50" id="#FF7F50">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#FF6347" id="#FF6347">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#FF8C00" id="#FF8C00">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#FFA500" id="#FFA500">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#FF4500" id="#FF4500">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#DC143C" id="#DC143C">&nbsp;</td>
			</tr>
			<tr>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#FF0000" id="#FF0000">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#FF1493" id="#FF1493">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#FF00FF" id="#FF00FF">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#FF69B4" id="#FF69B4">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#FFB6C1" id="#FFB6C1">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#FFC0CB" id="#FFC0CB">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#DB7093" id="#DB7093">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#C71585" id="#C71585">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#800080" id="#800080">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#8B008B" id="#8B008B">&nbsp;</td>
			</tr>
			<tr>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#9370DB" id="#9370DB">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#8A2BE2" id="#8A2BE2">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#4B0082" id="#4B0082">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#9400D3" id="#9400D3">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#9932CC" id="#9932CC">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#BA55D3" id="#BA55D3">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#DA70D6" id="#DA70D6">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#EE82EE" id="#EE82EE">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#DDA0DD" id="#DDA0DD">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#D8BFD8" id="#D8BFD8">&nbsp;</td>
			</tr>
			<tr>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#E6E6FA" id="#E6E6FA">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#F8F8FF" id="#F8F8FF">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#F0F8FF" id="#F0F8FF">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#F5FFFA" id="#F5FFFA">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#F0FFF0" id="#F0FFF0">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#FAFAD2" id="#FAFAD2">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#FFFACD" id="#FFFACD">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#FFF8DC" id="#FFF8DC">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#FFFFE0" id="#FFFFE0">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#FFFFF0" id="#FFFFF0">&nbsp;</td>
			</tr>
			<tr>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#FFFAF0" id="#FFFAF0">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#FAF0E6" id="#FAF0E6">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#FDF5E6" id="#FDF5E6">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#FAEBD7" id="#FAEBD7">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#FFE4C4" id="#FFE4C4">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#FFDAB9" id="#FFDAB9">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#FFEFD5" id="#FFEFD5">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#FFF5EE" id="#FFF5EE">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#FFF0F5" id="#FFF0F5">&nbsp;</td>
				<td onMouseOver="parent.showColor(document.getElementById('selectedColor'), this)" onClick="parent.applyColor(this)" style="background-color:#FFE4E1" id="#FFE4E1">&nbsp;</td>
			</tr>
		</table>
	</DIV>
	<!-- end color menu -->

	<script>
	window.onError = function() { return false; }

	function LTrim(str)
	{
	   var whitespace = new String(" \t\n\r");

	   var s = new String(str);

	   if (whitespace.indexOf(s.charAt(0)) != -1) {

		  var j=0, i = s.length;

		  while (j < i && whitespace.indexOf(s.charAt(j)) != -1)
			 j++;

		  s = s.substring(j, i);
	   }
	   return s;
	}


	function doLoad()
	{
		html = ('%VALUE%');

		getIFrameDocument("foo").designMode = "On";

		if (LTrim(html) != "") {
			getIFrameDocument("foo").open();
			getIFrameDocument("foo").write(html);
			getIFrameDocument("foo").close();
		}
		

		document.getElementById("foo").style.height = (%HEIGHT%)-60
		document.getElementById("foo").style.backgroundColor = "#FFFFFF";

		if (browser.NS) {
		  document.addEventListener("mousedown", getHTML, true);
		  document.getElementById("foo").contentWindow.document.addEventListener("mousedown", getHTML, true);
		  document.addEventListener("keypress", getHTML, true);
		  document.getElementById("foo").contentWindow.document.addEventListener("keypress", getHTML, true);

		  document.addEventListener("mousedown", hidePalette, true);
		  document.getElementById("foo").contentWindow.document.addEventListener("mousedown", hidePalette, true);
		  document.addEventListener("keypress", hidePalette, true);
		  document.getElementById("foo").contentWindow.document.addEventListener("keypress", hidePalette, true);
		}
	}

	function hidePalette(e) {
		if (e.target.id == "") {
			document.getElementById("fontColor").innerHTML = ""
			document.getElementById("backColor").innerHTML = ""
		}
	}

	function getIFrameDocument(aID){
	  // if contentDocument exists, W3C compliant (Mozilla)
	  if (document.getElementById(aID).contentDocument){
		return document.getElementById(aID).contentDocument;
	  } else {
		// IE
		return document.frames[aID].document;
	  }
	} 

	function doCommand(aName, aArg){
		if (aName == "createlink") {
			if (browser.NS) {
				var aArg = prompt("Enter a URL:", "http://");
					if (aArg == "") {
						getIFrameDocument('foo').execCommand("Unlink", false, null);
					} else {
						getIFrameDocument('foo').execCommand(aName,false, aArg);
					}
			} else {
			  foo.document.execCommand(aName)
			}
		} else {
			getIFrameDocument('foo').execCommand(aName,false, aArg);
			// document.getElementById('foo').contentWindow.focus()
		}
	}

	function doFontColor() {
		if (browser.IE) {
		 	showMenu('colorMenu',180,291)
		} else {
			colorType = 0;
			colorPop = document.getElementById("fontColor");
			colorPop.style.position = "absolute";
			colorPop.innerHTML = document.getElementById("colorMenu").innerHTML;
		}
	}

	function doBackColor() {
		if (browser.IE) {
			showMenu('colorMenu2',180,291);
		} else {
			colorType = 2;
			colorPop = document.getElementById("backColor");
			colorPop.style.position = "absolute";
			colorPop.innerHTML = document.getElementById("colorMenu").innerHTML;
		}
	}

	function getHTML() {
		if (mode == 1) {
			if (browser.NS) {
				var html = document.getElementById('foo').contentWindow.document.body.ownerDocument.createRange();
				html.selectNodeContents(document.getElementById('foo').contentWindow.document.body);
				editorHTML = html.toString();
			} else {
				editorHTML = document.getElementById('foo').contentWindow.document.body.innerText
			}
		} else {
			editorHTML = "<html>" + document.getElementById('foo').contentWindow.document.documentElement.innerHTML + "</html>"
		}

		document.getElementById('%FIELD_ID%').value = editorHTML
	}

	</script>
	<script defer>
			document.getElementById('%FIELD_ID%').value = '%VALUE%'
	</script>